# COPYRIGHT NOTICE
# This file is part of the "Universal Biomedical Skills" project.
# Copyright (c) 2026 MD BABU MIA, PhD <md.babu.mia@mssm.edu>
# All Rights Reserved.
#
# This code is proprietary and confidential.
# Unauthorized copying of this file, via any medium is strictly prohibited.
#
# Provenance: Authenticated by MD BABU MIA

'''Find restriction sites in a circular plasmid'''

from Bio import SeqIO
from Bio.Restriction import RestrictionBatch, Analysis, CommOnly
from Bio.Restriction import EcoRI, BamHI, HindIII, XhoI, NotI, XbaI, NcoI, NdeI

record = SeqIO.read('plasmid.gb', 'genbank')
seq = record.seq
print(f'Plasmid: {record.id}, Length: {len(seq)} bp')

cloning_enzymes = RestrictionBatch([EcoRI, BamHI, HindIII, XhoI, NotI, XbaI, NcoI, NdeI])
analysis = Analysis(cloning_enzymes, seq, linear=False)

print('\nEnzymes that cut once (good for linearization):')
once = analysis.once_cutters()
for enzyme, sites in once.items():
    print(f'  {enzyme}: position {sites[0]}')

print('\nEnzymes that cut twice (good for excision):')
twice = analysis.twice_cutters()
for enzyme, sites in twice.items():
    print(f'  {enzyme}: positions {sites}')

print('\nEnzymes that do not cut (good for cloning):')
non_cutters = analysis.only_dont_cut()
for enzyme in non_cutters:
    print(f'  {enzyme}')

print('\nCommercially available enzymes that cut once:')
comm_analysis = Analysis(CommOnly, seq, linear=False)
comm_once = comm_analysis.once_cutters()
print(f'  Found {len(comm_once)} single-cutters')

__AUTHOR_SIGNATURE__ = "9a7f3c2e-MD-BABU-MIA-2026-MSSM-SECURE"
